{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualisation Climatique</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="header-section">
        <img src="{% static 'img/AGRIMET.png' %}" alt="AGRHYMET Logo" />
        <h1 class="text-3xl font-bold text-gray-800 mt-4">West Africa SubX Data</h1>
        <p class="mt-2">
            Experimental high-resolution subseasonal-scale forecasts.
            <br />
            *Please note that new maps are typically available by 9 am GMT each Friday; however, if the latest forecasts from all models are not available, the maps will also be updated on Saturday and Sunday at 9 am GMT.
        </p>
        <p class="mt-4">
            The maps below show high-resolution (5km X 5km) climate forecasts over the next 30 days for The Permanent Inter-State Committee for Drought Control in the Sahel/Comité permanent Inter-Etats de Lutte contre la Sécheresse dans le Sahel (CILSS)-monitored countries in West Africa. These maps are generated by performing a quantile mapping-based bias-correction and downscaling of the forecasts from the North American Multimodel Ensemble (NMME) SubX project (Pegion et al., 2019), which provides climate forecasts based on multiple climate models. We are currently using climate forecasts from 5 of those models. The bias-correction and downscaling process involves two key steps: (1) downscaling of the SubX forecasts from a spatial resolution of about 100 X 100km to 5km X 5km and (2) bias-correction of downscaled forecasts at a daily scale using downscaled hindcast and observation climatologies of 7-day windows centered on the target day sampled from 1999-2016.
        </p>
        <p class="mt-4">
            The maps show a multimodel forecast of (1) Consecutive dry days (longest spell of days with precipitation below 1mm) and anomaly, (2) total rainfall over the next 30 days, and (3) number of rainy days in weeks 1 to 4 that receive rainfall more than 0, 5, 10, 25, and 50mm. Multimodel forecast, in this case, is simply the median of the ensemble forecast of the above variables. In the near future, we plan to provide similar maps using temperature forecasts.
        </p>
        <p class="mt-4">
            These are experimental forecasts generated by the support of NASA-SERVIR Applied Sciences Team grant 80NSSC20K0163.
        </p>
    </div>
    <div class="flex flex-col lg:flex-row min-h-screen">
        <!-- Panneau gauche -->
        <div class="w-full lg:w-1/3 bg-white shadow-lg p-6">
            <h2 class="text-2xl font-bold text-gray-700 mb-4">Paramètres</h2>
           
            <div id="loader" class="spin">
                Loading...
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>

            </div>

            <div class="space-y-4">
                <div>
                    <label for="level-select" class="block text-lg font-semibold mb-2">Niveau</label>
                    <select id="level-select" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                        <option value="">--------------</option>
                        <option value="pays">Pays (admin-0)</option>
                        <option value="region">Région (admin-1)</option>
                    </select>
                </div>

                <div>
                    <label for="variable-select" class="block text-lg font-semibold mb-2">Variable</label>
                    <select id="variable-select" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                        <option value="">--------------</option>
                        <option value="Consecutive Dry Days">Consecutive Dry Days</option>
                        <option value="Total Rainfall in mm">Total Rainfall in mm</option>
                        <option value="Number of Rainy Days">Number of Rainy Days</option>
                        <option value="ETo forecasts-Experimental">ETo forecasts-Experimental</option>
                        <option value="Mean Tmax">Mean Tmax in deg C</option>
                        <option value="Mean Tmin">Mean Tmin in deg C</option>
                    </select>
                </div>
                <div>
                    <label for="sub-variable-select" class="block text-lg font-semibold mb-2">Sous-variable</label>
                    <select id="sub-variable-select" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                        <!-- Les sous-variables sont ajoutées dynamiquement via JavaScript -->
                    </select>
                </div>
            </div>
            
        </div>

        <!-- Panneau droit -->
        <div class="w-full lg:w-2/3 bg-gray-50 p-6 flex flex-col">
            <h2 class="text-2xl font-bold text-gray-700 mb-4" id="mapTitle">Interactive Map</h2>
            <h3 class="text-2xl font-bold text-gray-700 mb-4" id="mapSubTitle"></h3>
            <div id="map-container" class="flex-1 bg-gray-200 rounded-lg shadow-lg overflow-hidden"></div>
            
        </div>
    </div>
    <canvas id="stats" >
        <!-- Informations supplémentaires -->
    </canvas>
   

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'js/geojson.js' %}"></script>
    <script src="{% static 'js/dashboard.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    
</body>
</html>
